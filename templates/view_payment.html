{% extends '_base.html' %}

{% block title %}Payment Details{% endblock %}

{% block content %}
<div class="container-modern">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <!-- Header -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h2 style="font-size: 1.875rem; font-weight: 700; color: var(--gray-900); margin: 0;">
                        Payment Details
                    </h2>
                    <p style="color: var(--gray-600); margin: 0.25rem 0 0 0; font-size: 0.875rem;">
                        Receipt #{{ payment.receipt_number }}
                    </p>
                </div>
                <a href="{{ url_for('payments') }}" class="btn-secondary-modern">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.25rem;">
                        <line x1="19" y1="12" x2="5" y2="12"/>
                        <polyline points="12 19 5 12 12 5"/>
                    </svg>
                    Back to Payments
                </a>
            </div>

            <!-- Payment Card -->
            <div class="card-modern mb-4">
                <div class="card-header-modern">Payment Information</div>
                <div class="p-4">
                    <div class="row g-4">
                        <div class="col-md-6">
                            <label style="font-size: 0.8125rem; color: var(--gray-600); display: block; margin-bottom: 0.25rem;">Student</label>
                            <div style="font-weight: 600; color: var(--gray-900);">
                                {{ payment.first_name }} {{ payment.last_name }}
                            </div>
                            {% if payment.email %}
                            <div style="font-size: 0.875rem; color: var(--gray-600); margin-top: 0.25rem;">
                                {{ payment.email }}
                            </div>
                            {% endif %}
                        </div>
                        <div class="col-md-6">
                            <label style="font-size: 0.8125rem; color: var(--gray-600); display: block; margin-bottom: 0.25rem;">Amount</label>
                            <div style="font-size: 2rem; font-weight: 700; color: var(--success);">
                                ₱{{ "{:,.2f}".format(payment.amount) }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label style="font-size: 0.8125rem; color: var(--gray-600); display: block; margin-bottom: 0.25rem;">Payment Method</label>
                            <div>
                                <span class="badge-secondary-modern">
                                    {% if payment.payment_method == 'cash' %}Cash
                                    {% elif payment.payment_method == 'bank_transfer' %}Bank Transfer
                                    {% elif payment.payment_method == 'gcash' %}GCash
                                    {% elif payment.payment_method == 'check' %}Check
                                    {% else %}{{ payment.payment_method }}
                                    {% endif %}
                                </span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label style="font-size: 0.8125rem; color: var(--gray-600); display: block; margin-bottom: 0.25rem;">Payment Date</label>
                            <div style="font-weight: 600; color: var(--gray-900);">
                                {{ payment.payment_date }}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label style="font-size: 0.8125rem; color: var(--gray-600); display: block; margin-bottom: 0.25rem;">Receipt Number</label>
                            <div style="font-weight: 600; color: var(--gray-900);">
                                {{ payment.receipt_number }}
                            </div>
                        </div>
                        {% if payment.building_name and payment.room_number %}
                        <div class="col-md-6">
                            <label style="font-size: 0.8125rem; color: var(--gray-600); display: block; margin-bottom: 0.25rem;">Assignment</label>
                            <div style="font-weight: 600; color: var(--gray-900);">
                                {{ payment.building_name }} - Room {{ payment.room_number }}
                            </div>
                            {% if payment.monthly_rate %}
                            <div style="font-size: 0.875rem; color: var(--gray-600); margin-top: 0.25rem;">
                                Monthly Rate: ₱{{ "{:,.2f}".format(payment.monthly_rate) }}
                            </div>
                            {% endif %}
                        </div>
                        {% endif %}
                        {% if payment.payment_period_start and payment.payment_period_end %}
                        <div class="col-md-6">
                            <label style="font-size: 0.8125rem; color: var(--gray-600); display: block; margin-bottom: 0.25rem;">Payment Period</label>
                            <div style="font-weight: 600; color: var(--gray-900);">
                                {{ payment.payment_period_start }} to {{ payment.payment_period_end }}
                            </div>
                        </div>
                        {% endif %}
                        {% if payment.notes %}
                        <div class="col-12">
                            <label style="font-size: 0.8125rem; color: var(--gray-600); display: block; margin-bottom: 0.25rem;">Notes</label>
                            <div style="padding: 0.75rem; background: var(--gray-50); border-radius: 0.5rem; color: var(--gray-700);">
                                {{ payment.notes }}
                            </div>
                        </div>
                        {% endif %}
                        {% if payment.recorded_by_first and payment.recorded_by_last %}
                        <div class="col-md-6">
                            <label style="font-size: 0.8125rem; color: var(--gray-600); display: block; margin-bottom: 0.25rem;">Recorded By</label>
                            <div style="font-weight: 500; color: var(--gray-900);">
                                {{ payment.recorded_by_first }} {{ payment.recorded_by_last }}
                            </div>
                        </div>
                        {% endif %}
                        <div class="col-md-6">
                            <label style="font-size: 0.8125rem; color: var(--gray-600); display: block; margin-bottom: 0.25rem;">Created At</label>
                            <div style="font-weight: 500; color: var(--gray-900);">
                                {{ payment.created_at }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            {% if session.role == 'admin' %}
            <div class="d-flex gap-2 justify-content-end">
                <a href="{{ url_for('edit_payment', payment_id=payment.payment_id) }}" class="btn-primary-modern">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.25rem;">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                    </svg>
                    Edit Payment
                </a>
                <form method="POST" action="{{ url_for('delete_payment', payment_id=payment.payment_id) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this payment record? This action cannot be undone.');">
                    <button type="submit" class="btn-secondary-modern" style="background: var(--danger); color: white;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.25rem;">
                            <polyline points="3 6 5 6 21 6"/>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                        </svg>
                        Delete Payment
                    </button>
                </form>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
